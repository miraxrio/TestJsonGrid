{
    "Close Ports script": "# Install-Module Microsoft.Graph.Intune\nConnect-MgGraph -Scopes DeviceManagementConfiguration.ReadWrite.All\nEnsure that Microsoft Graph is installed and imported\nInstall-Module Microsoft.Graph.Intune -Force -AllowClobber\nImport-Module Microsoft.Graph.Intune\n# Connect to Microsoft Graph if not already connected\nif (-not (Get-MgContext)) {\nConnect-MgGraph -Scopes DeviceManagementConfiguration.ReadWrite.All\n}\n Define the password policy parameters\nminLength = 8\nrequireSpecialChar = true\nrequireNumber = true\nGet the existing password profile policy\npolicies = Get-MgDeviceManagementDeviceCompliancePolicy | Where-Object { passwordRequired -eq true }\nIf no password policy exists, create one\nif (policies.Count -eq 0) {\n    Write-Host No existing password policy found. Creating a new password policy...\n# Create a new password policy\nNew-MgDeviceManagementDeviceCompliancePolicy -PasswordRequired true -PasswordMinimumLength minLength\n-PasswordRequiredType alphanumeric -PasswordExpirationDays 0 -PasswordPreviousPasswordBlockCount 0 -DeviceThreatProtectionRequiredSecurityLevel unavailable}\nelse {# Update the existing password policy with the required settings\nforeach (policy in policies) {Write-Host Updating existing password policy: (policy.DisplayName)\nUpdate-MgDeviceManagementDeviceCompliancePolicy -DeviceCompliancePolicyId policy.Id -PasswordMinimumLength minLength\n-PasswordRequired true -PasswordRequiredType alphanumeric -PasswordMinimumCharacterSetCount 2\n}}\nWrite-Host Password policy updated successfully with the following requirements:\nWrite-Host  - Minimum Length: minLength\nWrite-Host  - Special Character Required: requireSpecialChar\nWrite-Host  - Number Required: requireNumber"
}
